{"ast":null,"code":"import * as i0 from \"@angular/core\";\nexport class VoiceRecognitionService {\n  constructor() {\n    this.isStoppedSpeechRecog = false;\n    this.tempWords = '';\n    this.text = '';\n    this.isListening = false;\n    this.transcript = new Subjec();\n    this.transcript$ = this.transcript.asObservable();\n    this.recognition.interimResults = true;\n    this.recognition.lang = 'en-US';\n  }\n  init() {\n    this.recognition.addEventListener('result', event => {\n      const transcript = Array.from(event.results).map(result => result[0]).map(result => result.transcript).join('');\n      this.tempWords = transcript;\n    });\n  }\n  start() {\n    this.isStoppedSpeechRecog = false;\n    this.recognition.start();\n    console.log('Speech recognition started');\n    this.recognition.addEventListener('end', () => {\n      if (this.isStoppedSpeechRecog) {\n        this.recognition.stop();\n        console.log('End speech recognition');\n      } else {\n        this.wordConcat();\n        this.recognition.start();\n      }\n    });\n  }\n  stop() {\n    this.isStoppedSpeechRecog = true;\n    this.wordConcat();\n    this.recognition.stop();\n    console.log('End speech recognition');\n  }\n  wordConcat() {\n    if (this.tempWords.trim()) {\n      this.text = `${this.text} ${this.tempWords}`.trim();\n      this.transcript.next(this.text); // Ajoute ça pour mettre à jour le flux observable\n      this.tempWords = '';\n    }\n  }\n  static {\n    this.ɵfac = function VoiceRecognitionService_Factory(t) {\n      return new (t || VoiceRecognitionService)();\n    };\n  }\n  static {\n    this.ɵprov = /*@__PURE__*/i0.ɵɵdefineInjectable({\n      token: VoiceRecognitionService,\n      factory: VoiceRecognitionService.ɵfac,\n      providedIn: 'root'\n    });\n  }\n}","map":{"version":3,"names":["VoiceRecognitionService","constructor","isStoppedSpeechRecog","tempWords","text","isListening","transcript","Subjec","transcript$","asObservable","recognition","interimResults","lang","init","addEventListener","event","Array","from","results","map","result","join","start","console","log","stop","wordConcat","trim","next","factory","ɵfac","providedIn"],"sources":["C:\\Users\\Malek\\Desktop\\pidev\\insurance-front\\src\\app\\services\\voice-recognition.service.ts"],"sourcesContent":["import { Injectable } from '@angular/core';\nimport { BehaviorSubject } from 'rxjs';\ndeclare var webkitSpeechRecognition: any;\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class VoiceRecognitionService {\n\n  recognition :any;\n  isStoppedSpeechRecog = false;\n  tempWords: string = '';\n  text: string = '';\n  isListening = false;\n  transcript = new Subjec<string>();\n\n  public transcript$ = this.transcript.asObservable();\n  constructor() {\n    this.recognition.interimResults = true;\n    this.recognition.lang = 'en-US';\n  }\n\n  init() {\n    this.recognition.addEventListener('result', (event: any) => {\n      const transcript = Array.from(event.results)\n        .map((result: any) => result[0])\n        .map((result: any) => result.transcript)\n        .join('');\n      this.tempWords = transcript;\n    });\n  }\n\n  start() {\n    this.isStoppedSpeechRecog = false;\n    this.recognition.start();\n    console.log('Speech recognition started');\n\n    this.recognition.addEventListener('end', () => {\n      if (this.isStoppedSpeechRecog) {\n        this.recognition.stop();\n        console.log('End speech recognition');\n      } else {\n        this.wordConcat();\n        this.recognition.start();\n      }\n    });\n  }\n\n  stop() {\n    this.isStoppedSpeechRecog = true;\n    this.wordConcat();\n    this.recognition.stop();\n    console.log('End speech recognition');\n  }\n\n  wordConcat() {\n    if (this.tempWords.trim()) {\n      this.text = `${this.text} ${this.tempWords}`.trim();\n      this.transcript.next(this.text); // Ajoute ça pour mettre à jour le flux observable\n      this.tempWords = '';\n    }\n  }\n  \n  \n}\n"],"mappings":";AAOA,OAAM,MAAOA,uBAAuB;EAUlCC,YAAA;IAPA,KAAAC,oBAAoB,GAAG,KAAK;IAC5B,KAAAC,SAAS,GAAW,EAAE;IACtB,KAAAC,IAAI,GAAW,EAAE;IACjB,KAAAC,WAAW,GAAG,KAAK;IACnB,KAAAC,UAAU,GAAG,IAAIC,MAAM,EAAU;IAE1B,KAAAC,WAAW,GAAG,IAAI,CAACF,UAAU,CAACG,YAAY,EAAE;IAEjD,IAAI,CAACC,WAAW,CAACC,cAAc,GAAG,IAAI;IACtC,IAAI,CAACD,WAAW,CAACE,IAAI,GAAG,OAAO;EACjC;EAEAC,IAAIA,CAAA;IACF,IAAI,CAACH,WAAW,CAACI,gBAAgB,CAAC,QAAQ,EAAGC,KAAU,IAAI;MACzD,MAAMT,UAAU,GAAGU,KAAK,CAACC,IAAI,CAACF,KAAK,CAACG,OAAO,CAAC,CACzCC,GAAG,CAAEC,MAAW,IAAKA,MAAM,CAAC,CAAC,CAAC,CAAC,CAC/BD,GAAG,CAAEC,MAAW,IAAKA,MAAM,CAACd,UAAU,CAAC,CACvCe,IAAI,CAAC,EAAE,CAAC;MACX,IAAI,CAAClB,SAAS,GAAGG,UAAU;IAC7B,CAAC,CAAC;EACJ;EAEAgB,KAAKA,CAAA;IACH,IAAI,CAACpB,oBAAoB,GAAG,KAAK;IACjC,IAAI,CAACQ,WAAW,CAACY,KAAK,EAAE;IACxBC,OAAO,CAACC,GAAG,CAAC,4BAA4B,CAAC;IAEzC,IAAI,CAACd,WAAW,CAACI,gBAAgB,CAAC,KAAK,EAAE,MAAK;MAC5C,IAAI,IAAI,CAACZ,oBAAoB,EAAE;QAC7B,IAAI,CAACQ,WAAW,CAACe,IAAI,EAAE;QACvBF,OAAO,CAACC,GAAG,CAAC,wBAAwB,CAAC;OACtC,MAAM;QACL,IAAI,CAACE,UAAU,EAAE;QACjB,IAAI,CAAChB,WAAW,CAACY,KAAK,EAAE;;IAE5B,CAAC,CAAC;EACJ;EAEAG,IAAIA,CAAA;IACF,IAAI,CAACvB,oBAAoB,GAAG,IAAI;IAChC,IAAI,CAACwB,UAAU,EAAE;IACjB,IAAI,CAAChB,WAAW,CAACe,IAAI,EAAE;IACvBF,OAAO,CAACC,GAAG,CAAC,wBAAwB,CAAC;EACvC;EAEAE,UAAUA,CAAA;IACR,IAAI,IAAI,CAACvB,SAAS,CAACwB,IAAI,EAAE,EAAE;MACzB,IAAI,CAACvB,IAAI,GAAG,GAAG,IAAI,CAACA,IAAI,IAAI,IAAI,CAACD,SAAS,EAAE,CAACwB,IAAI,EAAE;MACnD,IAAI,CAACrB,UAAU,CAACsB,IAAI,CAAC,IAAI,CAACxB,IAAI,CAAC,CAAC,CAAC;MACjC,IAAI,CAACD,SAAS,GAAG,EAAE;;EAEvB;;;uBAtDWH,uBAAuB;IAAA;EAAA;;;aAAvBA,uBAAuB;MAAA6B,OAAA,EAAvB7B,uBAAuB,CAAA8B,IAAA;MAAAC,UAAA,EAFtB;IAAM;EAAA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}